  <nz-layout class="h-screen">
    <!-- Sidebar -->
    <nz-sider nzCollapsible nzWidth="220px" class="bg-gray-900 text-white">
      <div class="logo text-center text-white py-4 text-xl font-bold">
        Company
      </div>
      <ul nz-menu nzTheme="dark" nzMode="inline" class="mt-4">
        <li nz-menu-item [nzSelected]="selectedView==='info'" (click)="selectView('info')">
          <span nz-icon nzType="user"></span>
          <span>Employee Info</span>
        </li>
        <li nz-menu-item [nzSelected]="selectedView==='hierarchy'" (click)="selectView('hierarchy')">
          <span nz-icon nzType="apartment"></span>
          <span>Hierarchy</span>
        </li>
        <li nz-menu-item [nzSelected]="selectedView==='settings'" (click)="selectView('settings')">
          <span nz-icon nzType="setting"></span>
          <span>Settings</span>
        </li>
        <li nz-menu-item (click)="logout()">
          <span nz-icon nzType="logout"></span>
          <span>Logout</span>
        </li>
      </ul>
    </nz-sider>
  
    <!-- Main Content -->
    <nz-layout>
      <nz-content class="p-6 bg-gray-50">
        <!-- Loading -->
        <nz-spin *ngIf="isLoading$ | async" nzTip="Loading..." class="w-full flex justify-center py-10"></nz-spin>
  
        <!-- Employee Info -->
        <div *ngIf="!(isLoading$ | async) && selectedView==='info' && employee">
          <h2 class="text-3xl font-bold mb-2">{{ employee.firstName }} {{ employee.lastName }}</h2>
          <p class="text-lg text-gray-600 mb-6">{{ employee.desc }}</p>
  
          <p class="text-green-600 font-medium text-xl mb-3">Employee Information</p>
          <nz-table #basicTable nzBordered [nzShowPagination]="false" class="w-1/2">
            <thead>
              <tr>
                <th>Field</th>
                <th>Value</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>Name</td><td>{{ employee.firstName }} {{ employee.lastName }}</td></tr>
              <tr><td>Email</td><td><a [href]="'mailto:' + employee.email">{{ employee.email }}</a></td></tr>
              <tr><td>Entry Date</td><td>{{ employee.createdAt | date:'MMMM d, y' }}</td></tr>
              <tr><td>Salary</td><td>{{ employee.salary | currency }}</td></tr>
              <tr><td>Description</td><td>{{ employee.desc }}</td></tr>
            </tbody>
          </nz-table>
  
          <div class="flex justify-between items-center mt-10 mb-2">
            <p class="text-green-600 font-medium text-xl">Employees Managed</p>
            <button nz-button nzType="primary" (click)="showAddEmployeeModal()">Add Employee</button>
          </div>
          <nz-table [nzData]="managedEmployees" [nzBordered]="true" [nzShowPagination]="false">
            <thead>
              <tr>
                <th>Name</th>
                <th>Position</th>
                <th>Email</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let emp of managedEmployees">
                <td>{{ emp.firstName }} {{ emp.lastName }}</td>
                <td>{{ emp.role.name }}</td>
                <td><a [href]="'mailto:' + emp.email">{{ emp.email }}</a></td>
                <td>
                  <button nz-button nzType="link" nzDanger (click)="showDeleteModal(emp)">
                    <i nz-icon nzType="delete"></i>
                  </button>
                </td>
              </tr>
            </tbody>
          </nz-table>
        </div>
  
        <!-- Hierarchy -->
        <div *ngIf="!(isLoading$ | async) && selectedView==='hierarchy'">
          <app-dashboard></app-dashboard>
        </div>
  
        <!-- Settings -->
        <div *ngIf="!(isLoading$ | async) && selectedView==='settings'">
          <h2 class="text-2xl font-bold mb-4">Change Password</h2>
          <form [formGroup]="changePasswordForm" (ngSubmit)="submitChangePassword()" class="max-w-md">
            <nz-form-item>
              <nz-form-label nzFor="oldPassword">Old Password</nz-form-label>
              <nz-form-control>
                <input nz-input formControlName="oldPassword" type="password" id="oldPassword" placeholder="Old Password" />
              </nz-form-control>
            </nz-form-item>
            <nz-form-item>
              <nz-form-label nzFor="newPassword">New Password</nz-form-label>
              <nz-form-control>
                <input nz-input formControlName="newPassword" type="password" id="newPassword" placeholder="New Password" />
              </nz-form-control>
            </nz-form-item>
            <nz-form-item>
              <nz-form-control>
                <button nz-button nzType="primary" [nzLoading]="isChangingPassword" [disabled]="!changePasswordForm.valid">Change Password</button>
              </nz-form-control>
            </nz-form-item>
          </form>
        </div>
  
        <nz-modal
          class="modal"
          [(nzVisible)]="isDeleteModalVisible"
          nzTitle="Confirm Delete"
          (nzOnOk)="confirmDelete()"
          (nzOnCancel)="cancelDelete()"
          [nzOkLoading]="isDeleting"
        >
          <p *nzModalContent>Are you sure you want to delete this employee?</p>
        </nz-modal>

        <nz-modal
          [(nzVisible)]="isAddEmployeeModalVisible"
          nzTitle="Add New Employee"
          (nzOnCancel)="cancelAddEmployee()"
          (nzOnOk)="handleAddEmployee()"
          [nzOkLoading]="isAddingEmployee"
        >
          <ng-container *nzModalContent>
            <form [formGroup]="addEmployeeForm">
              <nz-form-item>
                <nz-form-label [nzSm]="6" [nzXs]="24" nzFor="firstName">First Name</nz-form-label>
                <nz-form-control [nzSm]="14" [nzXs]="24">
                  <input nz-input formControlName="firstName" id="firstName" placeholder="First Name" />
                </nz-form-control>
              </nz-form-item>
              <nz-form-item>
                <nz-form-label [nzSm]="6" [nzXs]="24" nzFor="lastName">Last Name</nz-form-label>
                <nz-form-control [nzSm]="14" [nzXs]="24">
                  <input nz-input formControlName="lastName" id="lastName" placeholder="Last Name" />
                </nz-form-control>
              </nz-form-item>
              <nz-form-item>
                <nz-form-label [nzSm]="6" [nzXs]="24" nzFor="email">Email</nz-form-label>
                <nz-form-control [nzSm]="14" [nzXs]="24">
                  <input nz-input formControlName="email" id="email" placeholder="Email" />
                </nz-form-control>
              </nz-form-item>
              <nz-form-item>
                <nz-form-label [nzSm]="6" [nzXs]="24" nzFor="password">Password</nz-form-label>
                <nz-form-control [nzSm]="14" [nzXs]="24">
                  <input nz-input formControlName="password" type="password" id="password" placeholder="Password" />
                </nz-form-control>
              </nz-form-item>
              <nz-form-item>
                <nz-form-label [nzSm]="6" [nzXs]="24" nzFor="roleId">Role</nz-form-label>
                <nz-form-control [nzSm]="14" [nzXs]="24">
                  <nz-select formControlName="roleId" id="roleId" nzPlaceHolder="Select a role">
                    <nz-option *ngFor="let role of (roles$ | async)" [nzValue]="role.id" [nzLabel]="role.name"></nz-option>
                  </nz-select>
                </nz-form-control>
              </nz-form-item>
              <nz-form-item>
                <nz-form-label [nzSm]="6" [nzXs]="24" nzFor="salary">Salary</nz-form-label>
                <nz-form-control [nzSm]="14" [nzXs]="24">
                  <nz-input-number formControlName="salary" id="salary" [nzMin]="0" [nzStep]="1000"></nz-input-number>
                </nz-form-control>
              </nz-form-item>
              <nz-form-item>
                <nz-form-label [nzSm]="6" [nzXs]="24" nzFor="desc">Description</nz-form-label>
                <nz-form-control [nzSm]="14" [nzXs]="24">
                  <textarea nz-input formControlName="desc" id="desc" rows="3"></textarea>
                </nz-form-control>
              </nz-form-item>
            </form>
          </ng-container>
        </nz-modal>
      </nz-content>
    </nz-layout>
  </nz-layout>